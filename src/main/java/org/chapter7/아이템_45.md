## 아이템_45
### 스트림은 주의해서 사용하라

스트림 API 는 다량의 데이터 처리 작업을 돕고자 추가되었다.

이 API 가 제공하는 추상 개념 중 핵심은 두가지다.

1. 스트림은 데이터 원소의 유한 혹은 무한 시퀀스를 뜻한다.
2. 스트림 파이프라인은 이원소들로 수행하는 연산 단계를 표현하는 개념이다.

스트림의 원소들은 어디로부터든 올 수 있다.

스트림 파이프라인은 소스 스트림에서 시작해 종단 연산으로 끝나며, 그 사이에 하나 이상의 중간 연산이 있을 수 있다.

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

int sum = numbers.stream()            // 소스 스트림
                .filter(n -> n % 2 == 0)   // 중간 연산: 짝수만 필터링
                .mapToInt(n -> n * 2)       // 중간 연산: 각 요소를 2배로 변환
                .sum();                     // 종단 연산: 합계 계산
```
각 중간 연산은 스트림을 어떠한 방식으로 변환한다.

- 예컨대 각 원소에 함수를 적용하거나 특정 조건을 만족 못하는 원소를 걸러낼 수 있다.
- 스트림 파이프라인은 지연 평가 된다. 
  - 평가는 종단 연산이 호출 될 때 이뤄지며, 종단 연산에 쓰이지 않는 데이터 원소는 계산에 쓰이지 않는다.
  - 이러한 지연 평가가 무한 스트림을 다룰 수 있게 해주는 열쇠다.
  - ***종단 연산이 없는 스트림 파이프 라인은 아무 일도 하지 않는 명령어인 no-op과 같으니, 종단 연산을 빼먹는 일이 절대 없도록 하자.***



### 주의점  

- 스트림을 과용하면 프로그램이 읽거나 유지보수하기 어려워진다.
- char 값들을 처리할 때는 스트림을 삼가하는 편이 낫다.
  - `"hello world!".chars().forEach(System.out::print);` 는 `hello world!` 를 출력하길 기대하지만 int 값을 출력한다.
- 스트림은 처음 쓰기 시작하면 모든 반복문을 스트림으로 바꾸고 싶은 유혹이 있겠지만, 서두르지 않는게 좋다.



---

## 마무리

스트림을 사용해야 멋지게 처리할 수 있는 일이 있고, 반복 방식이 더 알맞은 일도 있다.

그리고 수많은 작업이 이 둘을 조합했을 때 가장 멋지게 해결된다.

어느 쪽을 선택하는 확고부동한 규칙은 없지만 참고할 만한 지침 정도는 있다.

어느 쪽이 나은지가 확연히 드러나는 경우가 많겠지만, 아니더라도 방법은 있다.

***스트림과 반복 중 어느 쪽이 나은지 확신하기 어렵다면 둘 다 해보고 나은 쪽을 선택하라.***