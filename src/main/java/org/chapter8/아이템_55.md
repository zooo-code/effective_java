## 아이템_55

### 옵셔널 반환을 신중히 하라.

자바 8 전에는 메서드가 특정 조건에서 값을 반환할 수 없을 때 취할 수 있는 선택지가 두 가지 였다.

예외를 던지거나, (반환 타입이 객체 참조라면) null 을 반환하는 것이다.

하지만 두가지 방법 모두 허점이 있다.

1. 예외는 진짜 예외적인 상황에서만 사용해야 하며 예외를 생성할 때 스택 추적 전체를 캐벼ㅕ하므로 비용도 만만치 않다.
2. null 을 반환하면 이런 문제가 생기지 않지만, 그 나릉믜 문제가 있다. null 을 반환할 수 있는 메서드를 호출할 때는,
별도의 null 처리 코드를 추가해야한다.

null 처리를 무시하고 반환된 null 값을 어딘가에 저장해두면 언젠가 nullPointException 을 발생 시킨다.

즉 null 을 반환하게 한 실제 원인과는 전혀 상관없는 코드에서 말이다.

자바 8이 나오게 되면서 `Optional<T>` 라는 선택지가 생겼다.

이때 null 이 아닌 T 타입 참조를 하나 담거나, 혹은 아무것도 담지 않을 수 있다.

아무것도 담지 않은 옵셔널은 `비었다` 고 말한다.

반대로 어떤 값을 담은 옵셔널은 `비지 않았다` 고 한다.

옵셔널은 원소를 최대 1개 가질 수 있는 `불변` 컬렉션이다.

- 옵셔널을 반환하는 메서드는 예외를 던지는 메서드보다 유연하고 사용하기 쉬우며, `null` 을 반환하는 메서드보다 
오류 가능성이 적다.

- ***옵셔널을 반환하는 메서드에서는 절대 `null` 을 반환하지 말자.***


- 추가로, ***컬렉션, 스트림, 배열, 옵셔널 같은 컨테이너 타입은 옵셔널로 감싸면 안된다.***

- 박싱된 기본 타입을 담는 옵셔널은 기본 타입 자체보다 무거울 수밖에 없다. ***박싱된 기본 타입을 담은 옵셔널을 반환하는 일은 없도록 하자.***


---

## 마무리

값을 반환하지 못할 가능성이 있고, 호출할 때마다 반환 값이 없을 가능성을 염두에 둬야하는 메서드라면

옵셔널을 반환해야 할 상황일 수 있다.

하지만 옵셔널 반환에는 성능 저하가 뒤따르니, 성능에 민감한 메서드라면 null 을 반환하거나 예외를 던지는 편이 나을 수 있다.

그리고 옵셔널은 반환값 이외의 용도로 쓰는 경우는 매우 드물다.